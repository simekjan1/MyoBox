<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P≈ô√≠stupn√° kalkulaƒçka</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* Z√°kladn√≠ styly pro tƒõlo str√°nky */
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column; /* Zmƒõnƒõno na column pro um√≠stƒõn√≠ tlaƒç√≠tka Zpƒõt */
            justify-content: flex-start; /* Zarovn√°n√≠ nahoru */
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
            transition: background-color 0.5s ease, color 0.5s ease; /* Plynul√Ω p≈ôechod pro zmƒõnu motivu */
        }

        /* Tmav√Ω motiv (v√Ωchoz√≠) */
        body.dark-theme {
            background-color: #000; /* ƒåern√© pozad√≠ pro nejvy≈°≈°√≠ kontrast */
            color: #fff; /* B√≠l√Ω text */
        }
        body.dark-theme .wrapper {
            background-color: #1a1a1a; /* Tmav≈°√≠ pozad√≠ pro kontejner */
        }
        body.dark-theme #result {
            background-color: #000; /* ƒåern√© pozad√≠ pro displej */
            color: #fff; /* B√≠l√Ω text na displeji */
            border: 2px solid #555; /* Viditeln√© ohraniƒçen√≠ */
        }
        body.dark-theme .calculator-button {
            background-color: #333; /* Tmav√© pozad√≠ tlaƒç√≠tek */
            color: #fff; /* B√≠l√Ω text tlaƒç√≠tek */
            border: 2px solid #555; /* Viditeln√© ohraniƒçen√≠ */
        }
        body.dark-theme .calculator-button:hover {
            background-color: #555;
        }
        body.dark-theme .operator-button {
            background-color: #6a5acd; /* Fialov√° pro oper√°tory */
            border: 2px solid #8a2be2; /* Fialov√© ohraniƒçen√≠ */
        }
        body.dark-theme .operator-button:hover {
            background-color: #5a4ac0;
        }

        /* Svƒõtl√Ω motiv */
        body.light-theme {
            background-color: rgb(7, 210, 199); /* Svƒõtl√© pozad√≠ */
            color: rgb(87, 87, 87); /* Tmav≈°√≠ text */
        }
        body.light-theme .wrapper {
            background-color: #f0f0f0; /* Svƒõtlej≈°√≠ pozad√≠ pro kontejner */
        }
        body.light-theme #result {
            background-color: #fff;
            color: rgb(87, 87, 87);
            border: 2px solid #ccc; /* Svƒõtlej≈°√≠ ohraniƒçen√≠ */
        }
        body.light-theme .calculator-button {
            background-color: #fff;
            color: rgb(122, 122, 122);
            border: 2px solid #ccc; /* Svƒõtlej≈°√≠ ohraniƒçen√≠ */
        }
        body.light-theme .calculator-button:hover {
            background-color: rgb(37, 35, 59);
            color: #fff;
        }
        body.light-theme .operator-button {
            background-color: #a08aff; /* Svƒõtlej≈°√≠ fialov√° pro oper√°tory */
            border: 2px solid #8a6be2; /* Fialov√© ohraniƒçen√≠ */
        }
        body.light-theme .operator-button:hover {
            background-color: #8a6be2;
        }
        body.light-theme #clear-button {
            background-color: #dc3545; /* ƒåerven√° pro C */
            color: white;
            border: 2px solid #c82333; /* ƒåerven√© ohraniƒçen√≠ */
        }
        body.light-theme #clear-button:hover {
            background-color: #c82333;
        }
        body.light-theme #equals-button {
            background-color: #28a745; /* Zelen√° pro = */
            color: white;
            border: 2px solid #218838; /* Zelen√© ohraniƒçen√≠ */
        }
        body.light-theme #equals-button:hover {
            background-color: #218838;
        }


        /* Spoleƒçn√© styly pro prvky kalkulaƒçky */
        .wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            padding: 2rem; /* Vƒõt≈°√≠ padding */
            max-width: 450px; /* Vƒõt≈°√≠ ≈°√≠≈ôka */
            width: 100%;
            transition: background-color 0.5s ease; /* Plynul√Ω p≈ôechod pro wrapper */
        }

        h1 {
            font-size: 2.5rem; /* Vƒõt≈°√≠ nadpis */
            font-weight: 700;
            color: #4caf50; /* Zelen√° barva pro nadpis */
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 1rem;
        }

        .top-buttons {
            display: flex;
            align-items: center;
        }

        .theme-button {
            background-color: #6a5acd; /* Fialov√° */
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px; /* Vƒõt≈°√≠ tlaƒç√≠tko motivu */
            height: 45px; /* Vƒõt≈°√≠ tlaƒç√≠tko motivu */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            margin-left: 10px;
            flex-shrink: 0; /* Zabr√°n√≠ zmen≈°en√≠ tlaƒç√≠tka */
        }

        .theme-button:hover {
            background-color: #5a4ac0;
            transform: translateY(-2px);
        }
        .theme-button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        #theme-icon {
            width: 25px; /* Vƒõt≈°√≠ ikona motivu */
            height: 25px; /* Vƒõt≈°√≠ ikona motivu */
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(6, 1fr); /* Zmƒõnƒõno na 6 ≈ô√°dk≈Ø pro nov√© rozlo≈æen√≠ */
            gap: 12px; /* Vƒõt≈°√≠ mezery mezi tlaƒç√≠tky */
            width: 100%;
        }

        #result {
            grid-column: 1 / span 4; /* Zabere v≈°echny 4 sloupce */
            grid-row: 1 / 2; /* Prvn√≠ ≈ô√°dek */
            border-radius: 8px;
            padding: 1.5rem 1.2rem; /* Vƒõt≈°√≠ padding */
            font-size: 3rem; /* Je≈°tƒõ vƒõt≈°√≠ p√≠smo pro v√Ωsledek */
            text-align: right;
            margin-bottom: 10px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.4);
            outline: none;
            height: 90px; /* Vƒõt≈°√≠ v√Ω≈°ka */
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease; /* Plynul√Ω p≈ôechod */
        }

        .calculator-button {
            border-radius: 10px; /* V√≠ce zaoblen√© rohy */
            padding: 1.5rem; /* Vƒõt≈°√≠ padding */
            font-size: 2.2rem; /* Vƒõt≈°√≠ p√≠smo tlaƒç√≠tek */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 80px; /* Vƒõt≈°√≠ v√Ω≈°ka tlaƒç√≠tek */
            outline: none;
        }

        .calculator-button:hover {
            transform: translateY(-2px);
        }
        .calculator-button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .calculator-button:focus {
            outline: 4px solid #8a2be2; /* Fialov√Ω r√°meƒçek pro fokus */
            outline-offset: -4px;
        }

        /* Specifick√© barvy pro tlaƒç√≠tka C a = (nemƒõn√≠ se s motivem) */
        #clear-button {
            background-color: #dc3545; /* ƒåerven√° pro C */
            color: white;
            border: 2px solid #c82333; /* ƒåerven√© ohraniƒçen√≠ */
        }
        #clear-button:hover {
            background-color: #c82333;
        }
        
        #equals-button {
            background-color: #28a745; /* Zelen√° pro = */
            color: white;
            border: 2px solid #218838; /* Zelen√© ohraniƒçen√≠ */
        }
        #equals-button:hover {
            background-color: #218838;
        }

        /* Skryt√° oblast pro ƒçteƒçku obrazovky */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Styl pro tlaƒç√≠tko Zpƒõt na Dashboard */
        .back-to-dashboard-link {
            display: block; /* Aby zab√≠ralo celou ≈°√≠≈ôku a bylo na samostatn√©m ≈ô√°dku */
            width: fit-content; /* Aby se ≈°√≠≈ôka p≈ôizp≈Øsobila obsahu */
            background-color: #4a4a4a;
            color: #fff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 1.5rem; /* Mezera pod tlaƒç√≠tkem */
            transition: background-color 0.2s ease;
        }
        .back-to-dashboard-link:hover {
            background-color: #6a6a6a;
        }
        .back-to-dashboard-link:focus {
            outline: 2px solid #facc15;
            outline-offset: 2px;
        }

        /* Responsivn√≠ √∫pravy */
        @media (max-width: 480px) {
            .wrapper {
                padding: 1rem;
            }
            h1 {
                font-size: 2rem; /* Men≈°√≠ nadpis na mobilu */
                margin-bottom: 1rem;
            }
            #result {
                font-size: 2.2rem; /* Men≈°√≠ p√≠smo v√Ωsledku na mobilu */
                height: 80px;
            }
            .calculator-button {
                font-size: 1.8rem; /* Men≈°√≠ p√≠smo tlaƒç√≠tek na mobilu */
                height: 70px;
                padding: 1rem;
            }
            .theme-button {
                width: 40px;
                height: 40px;
            }
            #theme-icon {
                width: 20px;
                height: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Odkaz zpƒõt na Dashboard -->
    <a href="../../../index.html" class="back-to-dashboard-link" aria-label="Zpƒõt na hlavn√≠ dashboard JSM">‚Üê Zpƒõt na Dashboard</a>

    <div class="wrapper">
        <div class="header-container">
            <h1 id="toast" aria-live="polite" aria-atomic="true">Kalkulaƒçka</h1>
            <div class="top-buttons">
                <button type="button" onclick="changeTheme()" class="theme-button" aria-label="P≈ôepnout motiv">
                    <img src="https://placehold.co/25x25/ffffff/000000?text=‚òÄÔ∏è" alt="Ikona motivu" height="25" width="25" id="theme-icon">
                </button>
            </div>
        </div>
        
        <input type="text" name="result" id="result" placeholder="V√Ωsledek" readonly aria-live="assertive" aria-atomic="true" aria-label="Aktu√°ln√≠ v√Ωsledek">

        <div class="calculator-grid" role="grid" aria-label="Kalkulaƒçka">
            <!-- Row 1: %, CE, C, / -->
            <button type="button" value="%" onclick="liveScreen('%', 'procenta')" class="calculator-button operator-button" aria-label="Oper√°tor procenta">%</button>
            <button type="button" value="CE" onclick="clearLastEntry()" class="calculator-button operator-button" aria-label="Vymazat posledn√≠ vstup">CE</button>
            <button type="button" onclick="clearResult()" id="clear-button" class="calculator-button" aria-label="Vymazat v≈°e">C</button>
            <button type="button" value="/" onclick="liveScreen('/', 'dƒõleno')" class="calculator-button operator-button" aria-label="Oper√°tor dƒõleno">/</button>

            <!-- Row 2: 7, 8, 9, x -->
            <button type="button" value="7" onclick="liveScreen('7', 'sedm')" class="calculator-button" aria-label="ƒå√≠slo sedm">7</button>
            <button type="button" value="8" onclick="liveScreen('8', 'osm')" class="calculator-button" aria-label="ƒå√≠slo osm">8</button>
            <button type="button" value="9" onclick="liveScreen('9', 'devƒõt')" class="calculator-button" aria-label="ƒå√≠slo devƒõt">9</button>
            <button type="button" value="x" onclick="liveScreen('*', 'kr√°t')" class="calculator-button operator-button" aria-label="Oper√°tor kr√°t">x</button>

            <!-- Row 3: 4, 5, 6, - -->
            <button type="button" value="4" onclick="liveScreen('4', 'ƒçty≈ôi')" class="calculator-button" aria-label="ƒå√≠slo ƒçty≈ôi">4</button>
            <button type="button" value="5" onclick="liveScreen('5', 'pƒõt')" class="calculator-button" aria-label="ƒå√≠slo pƒõt">5</button>
            <button type="button" value="6" onclick="liveScreen('6', '≈°est')" class="calculator-button" aria-label="ƒå√≠slo ≈°est">6</button>
            <button type="button" value="-" onclick="liveScreen('-', 'minus')" class="calculator-button operator-button" aria-label="Oper√°tor minus">-</button>

            <!-- Row 4: 1, 2, 3, + -->
            <button type="button" value="1" onclick="liveScreen('1', 'jedna')" class="calculator-button" aria-label="ƒå√≠slo jedna">1</button>
            <button type="button" value="2" onclick="liveScreen('2', 'dva')" class="calculator-button" aria-label="ƒå√≠slo dva">2</button>
            <button type="button" value="3" onclick="liveScreen('3', 't≈ôi')" class="calculator-button" aria-label="ƒå√≠slo t≈ôi">3</button>
            <button type="button" value="+" onclick="liveScreen('+', 'plus')" class="calculator-button operator-button" aria-label="Oper√°tor plus">+</button>

            <!-- Row 5: 0, ., = (spanning 2 rows) -->
            <button type="button" value="0" onclick="liveScreen('0', 'nula')" class="calculator-button" aria-label="ƒå√≠slo nula">0</button>
            <button type="button" value="." onclick="liveScreen('.', 'desetinn√° ƒç√°rka')" class="calculator-button" aria-label="Desetinn√° ƒç√°rka">.</button>
            <button type="button" value="=" onclick="calculateResult()" id="equals-button" class="calculator-button operator-button" aria-label="Rovn√° se, vypoƒç√≠tat v√Ωsledek">=</button>
        </div>
    </div>

    <!-- Oblast pro dynamick√© ozn√°men√≠ ƒçteƒçce obrazovky -->
    <div id="announcer" class="sr-only" aria-live="polite" aria-atomic="true"></div>

    <script>
        const res = document.getElementById("result");
        const toast = document.getElementById("toast");
        const themeIcon = document.getElementById("theme-icon");
        const announcer = document.getElementById("announcer");

        // Ikony pro motivy (Pou≈æ√≠v√°me placehold.co pro jednoduchost, v re√°lu by byly SVG nebo Font Awesome)
        const lightThemeIcon = "https://placehold.co/25x25/ffffff/000000?text=‚òÄÔ∏è"; // Slunce na svƒõtl√©m pozad√≠
        const darkThemeIcon = "https://placehold.co/25x25/000000/ffffff?text=üåô"; // Mƒõs√≠c na tmav√©m pozad√≠

        /**
         * Funkce pro v√Ωpoƒçet v√Ωsledku.
         * Pou≈æ√≠v√° eval() pro vyhodnocen√≠ matematick√©ho v√Ωrazu.
         * Ozn√°m√≠ v√Ωsledek nebo chybu ƒçteƒçce obrazovky.
         */
        function calculateResult() {
            let expression = res.value;
            let calculatedValue;

            // Nahradit 'x' za '*' pro eval
            expression = expression.replace(/x/g, '*');

            try {
                calculatedValue = eval(expression);
                if (isNaN(calculatedValue) || !isFinite(calculatedValue)) {
                    res.value = "Chyba";
                    announceToScreenReader("Chyba ve v√Ωpoƒçtu.");
                    setTimeout(() => { res.value = ""; }, 1500);
                } else {
                    res.value = calculatedValue;
                    announceToScreenReader(`V√Ωsledek je ${calculatedValue}.`);
                }
            } catch (e) {
                res.value = "Chyba";
                announceToScreenReader("Chyba ve v√Ωrazu.");
                setTimeout(() => { res.value = ""; }, 1500);
            }
        }

        /**
         * Vyma≈æe obsah displeje kalkulaƒçky a ozn√°m√≠ to ƒçteƒçce obrazovky.
         */
        function clearResult() {
            res.value = "";
            announceToScreenReader("Displej vymaz√°n.");
        }

        /**
         * Vyma≈æe posledn√≠ zadan√Ω vstup (ƒç√≠slo nebo oper√°tor).
         * Tato funkce je p≈ôid√°na pro tlaƒç√≠tko "CE".
         */
        function clearLastEntry() {
            let currentExpression = res.value;
            // Pou≈æijeme regul√°rn√≠ v√Ωraz pro odstranƒõn√≠ posledn√≠ho ƒç√≠sla nebo oper√°toru
            // Toto je zjednodu≈°en√° verze, kter√° nemus√≠ b√Ωt dokonal√° pro slo≈æit√© v√Ωrazy
            res.value = currentExpression.replace(/(\s*[-+*/%x]?\s*\d*\.?\d*)$/, '');
            announceToScreenReader("Posledn√≠ vstup vymaz√°n.");
        }

        /**
         * P≈ôep√≠n√° mezi svƒõtl√Ωm a tmav√Ωm motivem.
         * Ozn√°m√≠ zmƒõnu motivu ƒçteƒçce obrazovky.
         */
        function changeTheme() {
            const body = document.body;
            if (body.classList.contains('light-theme')) {
                body.classList.remove('light-theme');
                body.classList.add('dark-theme');
                themeIcon.setAttribute("src", lightThemeIcon);
                toast.textContent = "Tmav√Ω re≈æim üåô";
                announceToScreenReader("Tmav√Ω re≈æim aktivov√°n.");
            } else {
                body.classList.remove('dark-theme');
                body.classList.add('light-theme');
                themeIcon.setAttribute("src", darkThemeIcon);
                toast.textContent = "Svƒõtl√Ω re≈æim ‚òÄÔ∏è";
                announceToScreenReader("Svƒõtl√Ω re≈æim aktivov√°n.");
            }
            // Kr√°tk√© zpo≈ædƒõn√≠ pro ozn√°men√≠, pak n√°vrat k "Kalkulaƒçka"
            setTimeout(() => {
                toast.textContent = "Kalkulaƒçka";
            }, 1500);
        }

        /**
         * Zobrazuje zadanou hodnotu na displeji a oznamuje ji ƒçteƒçce obrazovky.
         * @param {string} enteredValue Hodnota, kter√° se m√° zobrazit.
         * @param {string} announcementText Text pro ozn√°men√≠ ƒçteƒçce obrazovky (nap≈ô. "plus" m√≠sto "+").
         */
        function liveScreen(enteredValue, announcementText) {
            if (res.value === "Chyba") {
                res.value = ""; // Vyma≈æe chybu p≈ôed zad√°n√≠m nov√©ho vstupu
            }
            res.value += enteredValue;
            announceToScreenReader(announcementText);
        }

        /**
         * Ozn√°m√≠ zpr√°vu ƒçteƒçce obrazovky pomoc√≠ aria-live regionu.
         * @param {string} message Zpr√°va k ozn√°men√≠.
         */
        function announceToScreenReader(message) {
            announcer.textContent = message;
        }

        // P≈ôid√°n√≠ posluchaƒçe ud√°lost√≠ pro kl√°vesnicov√© vstupy
        document.addEventListener("keydown", keyboardInputHandler);

        /**
         * Funkce pro zpracov√°n√≠ kl√°vesnicov√Ωch vstup≈Ø.
         * @param {KeyboardEvent} e Ud√°lost kl√°vesnice.
         */
        function keyboardInputHandler(e) {
            e.preventDefault(); // Zabr√°n√≠ v√Ωchoz√≠mu chov√°n√≠ prohl√≠≈æeƒçe

            const key = e.key;
            let announcedText = '';

            // ƒå√≠sla
            if (key >= '0' && key <= '9') {
                liveScreen(key, `ƒç√≠slo ${key}`);
                return;
            }

            // Oper√°tory
            switch (key) {
                case '+':
                    liveScreen('+', 'plus');
                    break;
                case '-':
                    liveScreen('-', 'minus');
                    break;
                case '*':
                    liveScreen('*', 'kr√°t');
                    break;
                case '/':
                    liveScreen('/', 'dƒõleno');
                    break;
                case '.':
                    liveScreen('.', 'desetinn√° ƒç√°rka');
                    break;
                case 'Enter':
                    calculateResult();
                    break;
                case 'Backspace':
                    const resultInput = res.value;
                    res.value = resultInput.substring(0, res.value.length - 1);
                    announceToScreenReader("Posledn√≠ znak smaz√°n.");
                    break;
                case 'Escape': // P≈ôid√°no pro vymaz√°n√≠ displeje
                    clearResult();
                    break;
                default:
                    // Ignorovat ostatn√≠ kl√°vesy
                    return;
            }
        }

        // Nastaven√≠ v√Ωchoz√≠ho motivu (tmav√Ω)
        document.body.classList.add('dark-theme');
        themeIcon.setAttribute("src", lightThemeIcon); // Ikona slunce pro p≈ôepnut√≠ na svƒõtl√Ω motiv
    </script>
</body>
</html>
